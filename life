YPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æˆ‘çš„ç”Ÿæ´»ç´€éŒ„å™¨ - å°ˆæ¥­å…¨åŠŸèƒ½ç‰ˆ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap');
        :root { --ios-bg: #F2F2F7; --ios-card: #FFFFFF; }
        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            background-color: var(--ios-bg); 
            color: #1C1C1E; 
            -webkit-tap-highlight-color: transparent;
            line-height: 1.5;
        }
        .ios-card { background: var(--ios-card); border-radius: 20px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.03); margin-bottom: 12px; }
        .page { display: none; animation: fadeIn 0.3s ease-out; }
        .page.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        
        .nav-item.active { color: #4F46E5; }
        .photo-box { position: relative; aspect-ratio: 1/1; border-radius: 14px; border: 2px dashed #E2E8F0; background: #F8FAFC; display: flex; flex-direction: column; align-items: center; justify-content: center; overflow: hidden; cursor: pointer; }
        .photo-box img { width: 100%; height: 100%; object-fit: cover; position: absolute; top: 0; left: 0; }
        
        /* è«®è©¢è¦–åœ–å¾®å‹ç¸®åœ–å„ªåŒ– */
        .mini-photo-placeholder { width: 38px; height: 38px; border-radius: 8px; background: #F8FAFC; border: 1px dashed #CBD5E1; display: flex; align-items: center; justify-content: center; font-size: 9px; color: #94A3B8; font-weight: bold; }

        .portion-btn { width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; border-radius: 12px; background: #F1F5F9; font-weight: bold; }
        .toggle-btn { padding: 8px 12px; border-radius: 12px; font-size: 13px; font-weight: 700; background: #F1F5F9; color: #64748B; transition: all 0.2s; border: none; }
        .toggle-btn.active { background: #4F46E5; color: white; box-shadow: 0 4px 10px rgba(79, 70, 229, 0.3); }
        
        .target-tag { font-size: 10px; background: #EEF2FF; color: #4F46E5; padding: 2px 6px; border-radius: 6px; font-weight: 900; }
        
        input[type="range"] { height: 6px; -webkit-appearance: none; background: #E2E8F0; border-radius: 5px; accent-color: #4F46E5; }
        select { -webkit-appearance: none; background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2364748B' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='m6 9 6 6 6-6'/%3E%3C/svg%3E"); background-repeat: no-repeat; background-position: right 8px center; padding-right: 30px; }
    </style>
</head>
<body class="pb-28">

    <!-- 1. ç´€éŒ„é é¢ -->
    <div id="record-page" class="page active">
        <header class="p-6 pb-2">
            <h1 class="text-3xl font-black tracking-tight text-slate-800">ä»Šæ—¥ç´€éŒ„</h1>
            <p id="current-date" class="text-slate-500 font-bold text-lg"></p>
        </header>

        <main class="px-4 mt-2">
            <!-- æ ¸å¿ƒæ•¸æ“šå€ -->
            <div class="ios-card p-5">
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-slate-50 p-4 rounded-2xl">
                        <span class="text-xs font-bold text-slate-400 uppercase block mb-1">é«”é‡ (kg)</span>
                        <input type="number" id="input-weight" step="0.1" value="65.2" class="text-2xl font-black text-slate-800 w-full bg-transparent border-none p-0 focus:ring-0">
                    </div>
                    <div class="bg-slate-50 p-4 rounded-2xl">
                        <span class="text-xs font-bold text-slate-400 uppercase block mb-1">è…°åœ (cm)</span>
                        <input type="number" id="input-waist" step="0.1" value="82.0" class="text-2xl font-black text-slate-800 w-full bg-transparent border-none p-0 focus:ring-0">
                    </div>
                </div>
            </div>

            <!-- é£²é£Ÿç´€éŒ„å€ -->
            <div class="ios-card p-5">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-base font-black text-slate-800 flex items-center gap-2">
                        <i data-lucide="utensils" class="w-5 h-5 text-orange-500"></i> é£²é£Ÿèˆ‡ä»½é‡ç´€éŒ„
                    </h3>
                    <div class="flex gap-1">
                        <span class="target-tag">ç›®æ¨™ 2.5/2.5/3</span>
                    </div>
                </div>
                
                <div class="space-y-3 mb-6">
                    <div class="flex items-center justify-between bg-slate-50 p-3 rounded-xl">
                        <div><span class="text-sm font-bold text-slate-700 block">ğŸš ä¸»é£Ÿ (ç›®æ¨™ 2.5)</span></div>
                        <div class="flex items-center gap-4">
                            <button onclick="updatePortion('carbs', -0.5)" class="portion-btn text-slate-400"><i data-lucide="minus" class="w-4 h-4"></i></button>
                            <span id="val-carbs" class="text-xl font-black w-8 text-center">1.5</span>
                            <button onclick="updatePortion('carbs', 0.5)" class="portion-btn text-indigo-600 bg-indigo-50"><i data-lucide="plus" class="w-4 h-4"></i></button>
                        </div>
                    </div>
                    <div class="flex items-center justify-between bg-slate-50 p-3 rounded-xl">
                        <div><span class="text-sm font-bold text-slate-700 block">ğŸ— è›‹ç™½è³ª (ç›®æ¨™ 2.5)</span></div>
                        <div class="flex items-center gap-4">
                            <button onclick="updatePortion('protein', -0.5)" class="portion-btn text-slate-400"><i data-lucide="minus" class="w-4 h-4"></i></button>
                            <span id="val-protein" class="text-xl font-black w-8 text-center">2.0</span>
                            <button onclick="updatePortion('protein', 0.5)" class="portion-btn text-indigo-600 bg-indigo-50"><i data-lucide="plus" class="w-4 h-4"></i></button>
                        </div>
                    </div>
                    <div class="flex items-center justify-between bg-slate-50 p-3 rounded-xl">
                        <div><span class="text-sm font-bold text-slate-700 block">ğŸ¥¦ è”¬èœ (ç›®æ¨™ 3.0)</span></div>
                        <div class="flex items-center gap-4">
                            <button onclick="updatePortion('veg', -0.5)" class="portion-btn text-slate-400"><i data-lucide="minus" class="w-4 h-4"></i></button>
                            <span id="val-veg" class="text-xl font-black w-8 text-center">2.5</span>
                            <button onclick="updatePortion('veg', 0.5)" class="portion-btn text-indigo-600 bg-indigo-50"><i data-lucide="plus" class="w-4 h-4"></i></button>
                        </div>
                    </div>

                    <div class="flex items-center justify-between pt-2">
                        <span class="text-sm font-bold text-slate-700">ğŸ’§ 2. é£²æ°´é‡ (cc)</span>
                        <input type="number" step="100" value="2000" class="w-24 bg-slate-100 rounded-xl px-3 py-2 text-right font-black text-indigo-600 border-none focus:ring-2 focus:ring-indigo-200">
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-3 mb-6">
                    <div class="space-y-2">
                        <span class="text-xs font-black text-slate-400 uppercase">3. é‚ªæƒ¡é£Ÿç‰©</span>
                        <div class="flex gap-1">
                            <button onclick="toggleBtn(this)" class="toggle-btn flex-1">æ˜¯</button>
                            <button onclick="toggleBtn(this)" class="toggle-btn flex-1 active">å¦</button>
                        </div>
                    </div>
                    <div class="space-y-2">
                        <span class="text-xs font-black text-slate-400 uppercase">4. æ˜¯å¦èšé¤</span>
                        <div class="flex gap-1">
                            <button onclick="toggleBtn(this)" class="toggle-btn flex-1">æ˜¯</button>
                            <button onclick="toggleBtn(this)" class="toggle-btn flex-1 active">å¦</button>
                        </div>
                    </div>
                </div>

                <div class="space-y-3 mb-4">
                    <span class="text-xs font-black text-slate-400 uppercase">10. é£½è¶³æ„Ÿç‹€æ³</span>
                    <input type="range" class="w-full" min="1" max="10" value="7">
                    <div class="flex justify-between text-[11px] font-bold text-slate-400 px-1">
                        <span>æ¥µé¤“</span><span>å‰›å¥½</span><span>éæ’</span>
                    </div>
                </div>

                <div class="grid grid-cols-4 gap-2 mt-6">
                    <div onclick="triggerUpload('breakfast')" class="photo-box" id="box-breakfast"><img id="img-breakfast" class="hidden"><i data-lucide="coffee" class="w-5 h-5 text-slate-300"></i><span class="text-[10px] text-slate-400 font-bold mt-1">æ—©é¤</span></div>
                    <div onclick="triggerUpload('lunch')" class="photo-box" id="box-lunch"><img id="img-lunch" class="hidden"><i data-lucide="sun" class="w-5 h-5 text-slate-300"></i><span class="text-[10px] text-slate-400 font-bold mt-1">åˆé¤</span></div>
                    <div onclick="triggerUpload('dinner')" class="photo-box" id="box-dinner"><img id="img-dinner" class="hidden"><i data-lucide="moon" class="w-5 h-5 text-slate-300"></i><span class="text-[10px] text-slate-400 font-bold mt-1">æ™šé¤</span></div>
                    <div onclick="triggerUpload('selfie')" class="photo-box border-indigo-100 bg-indigo-50" id="box-selfie"><img id="img-selfie" class="hidden"><i data-lucide="camera" class="w-5 h-5 text-indigo-300"></i><span class="text-[10px] text-indigo-400 font-bold mt-1">é«”æ…‹</span></div>
                </div>
                <input type="file" id="file-breakfast" accept="image/*" capture="environment" class="hidden" onchange="previewImg(this, 'img-breakfast')">
                <input type="file" id="file-lunch" accept="image/*" capture="environment" class="hidden" onchange="previewImg(this, 'img-lunch')">
                <input type="file" id="file-dinner" accept="image/*" capture="environment" class="hidden" onchange="previewImg(this, 'img-dinner')">
                <input type="file" id="file-selfie" accept="image/*" capture="user" class="hidden" onchange="previewImg(this, 'img-selfie')">
            </div>

            <!-- ç”Ÿæ´»ç´€éŒ„å€ -->
            <div class="ios-card p-5">
                <h3 class="text-base font-black text-slate-800 mb-4 flex items-center gap-2">
                    <i data-lucide="activity" class="w-5 h-5 text-pink-500"></i> èº«é«”ç‹€æ…‹è‡ªæª¢
                </h3>
                <div class="space-y-6">
                    <div>
                        <div class="flex justify-between items-center mb-2">
                            <span class="text-sm font-bold text-slate-700">5. å‰ä¸€å¤©ç¡çœ ç‹€æ³</span>
                            <span class="text-base font-black text-indigo-600" id="sleep-val">7.5 hr</span>
                        </div>
                        <input type="range" class="w-full" min="0" max="12" step="0.5" value="7.5" oninput="document.getElementById('sleep-val').innerText = this.value + ' hr'">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-2">
                            <span class="text-xs font-black text-slate-400 uppercase">6. å£“åŠ›ç‹€æ³</span>
                            <select class="w-full bg-slate-50 border-none rounded-xl text-sm font-bold p-3">
                                <option>ä½ - æ”¾é¬†</option><option selected>ä¸­ - æ­£å¸¸</option><option>é«˜ - ç·Šç¹ƒ</option><option>æ¥µé«˜ - å´©æ½°</option>
                            </select>
                        </div>
                        <div class="space-y-2">
                            <span class="text-xs font-black text-slate-400 uppercase">7. ç–²å‹ç‹€æ³</span>
                            <select class="w-full bg-slate-50 border-none rounded-xl text-sm font-bold p-3">
                                <option>ç¥æ¸…æ°£çˆ½</option><option selected>æ™®é€š</option><option>æœ‰äº›ç–²æ†Š</option><option>æ¥µåº¦å‹ç´¯</option>
                            </select>
                        </div>
                    </div>
                    <div class="space-y-4">
                        <div class="space-y-2">
                            <span class="text-xs font-black text-slate-400 uppercase">8. ä¾¿ä¾¿ç‹€æ³</span>
                            <div class="flex flex-wrap gap-2">
                                <button onclick="toggleBtn(this)" class="toggle-btn flex-1 active">ğŸ’© é †æš¢</button>
                                <button onclick="toggleBtn(this)" class="toggle-btn flex-1">ğŸ§± ç¡¬/ä¹¾</button>
                                <button onclick="toggleBtn(this)" class="toggle-btn flex-1">ğŸŒŠ è»Ÿ/ç¨€</button>
                                <button onclick="toggleBtn(this)" class="toggle-btn flex-1">ğŸš« æ²’ä¸Š</button>
                            </div>
                        </div>
                        <div class="space-y-2">
                            <span class="text-xs font-black text-slate-400 uppercase">9. æ°´è…«ç‹€æ³</span>
                            <div class="flex flex-wrap gap-2">
                                <button onclick="toggleBtn(this)" class="toggle-btn flex-1 active">ç„¡</button>
                                <button onclick="toggleBtn(this)" class="toggle-btn flex-1">è¼•å¾®</button>
                                <button onclick="toggleBtn(this)" class="toggle-btn flex-1">æ˜é¡¯</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <button onclick="saveData()" id="save-btn" class="w-full bg-slate-900 text-white py-5 rounded-2xl font-black text-lg shadow-xl mb-10">ç¢ºèªå„²å­˜ä»Šæ—¥ç´€éŒ„</button>
        </main>
    </div>

    <!-- 2. æ¯é€±æª¢è¦– (é€±å ±è¡¨æ¨¡å¼) -->
    <div id="insights-page" class="page">
        <header class="p-6 pb-2">
            <h1 class="text-3xl font-black tracking-tight text-slate-800">æ¯é€±æª¢è¦–</h1>
            <p class="text-slate-500 font-bold text-lg">æ•¸æ“šè¶¨å‹¢èˆ‡ç”Ÿæ´»æ˜ç´°</p>
        </header>
        <main class="px-4 mt-2">
            <!-- åœ–è¡¨å€ -->
            <div class="ios-card p-5">
                <div class="flex justify-between items-center mb-4">
                    <span class="text-sm font-black text-slate-700">é«”é‡/è…°åœ é€±è¶¨å‹¢</span>
                    <div class="flex gap-3 text-[10px] font-bold">
                        <span class="flex items-center gap-1"><span class="w-2 h-0.5 bg-indigo-600"></span>é«”é‡</span>
                        <span class="flex items-center gap-1"><span class="w-2 h-0.5 border-t border-dashed border-pink-500"></span>è…°åœ</span>
                    </div>
                </div>
                <div class="h-44"><canvas id="proWeeklyChart"></canvas></div>
            </div>

            <!-- é€±ç´€éŒ„åˆ—è¡¨ -->
            <h2 class="text-lg font-black text-slate-800 ml-2 mb-3">æ¯æ—¥æ˜ç´°</h2>
            <div class="space-y-3 mb-24" id="weekly-details-list">
                <!-- ç”± JavaScript å‹•æ…‹ç”Ÿæˆ -->
            </div>
        </main>
    </div>

    <!-- 3. æ­·ç¨‹é é¢ -->
    <div id="history-page" class="page">
        <header class="p-6 pb-2">
            <h1 class="text-3xl font-black tracking-tight text-slate-800">æ­·å²æ­·ç¨‹</h1>
            <p class="text-slate-500 font-bold text-lg">é«”æ…‹è®ŠåŒ–èˆ‡ç…§ç‰‡å›é¡§</p>
        </header>
        <main class="px-4 mt-2">
            <div class="ios-card p-6 flex flex-col items-center justify-center text-slate-400 h-64 border-2 border-dashed border-slate-200 bg-white text-center">
                <i data-lucide="calendar" class="w-12 h-12 mb-4 opacity-20"></i>
                <p class="font-black text-slate-600">æ­·å²å¤§æ•¸æ“šé–‹ç™¼ä¸­</p>
                <p class="text-xs">å°‡åœ¨æ­¤æä¾›è·¨é€±ã€è·¨æœˆçš„é•·æœŸæ•¸æ“šåˆ†æ</p>
            </div>
        </main>
    </div>

    <!-- åº•éƒ¨å°è¦½ -->
    <nav class="fixed bottom-0 left-0 right-0 bg-white/95 backdrop-blur-2xl border-t border-slate-200 flex justify-around p-4 pb-8 z-50 shadow-2xl">
        <button onclick="switchPage('record')" id="nav-record" class="nav-item active flex flex-col items-center gap-1">
            <i data-lucide="pen-tool" class="w-6 h-6"></i>
            <span class="text-[11px] font-black">ä»Šæ—¥è¨˜éŒ„</span>
        </button>
        <button onclick="switchPage('insights')" id="nav-insights" class="nav-item flex flex-col items-center gap-1 text-slate-400">
            <i data-lucide="layout-list" class="w-6 h-6"></i>
            <span class="text-[11px] font-black">æ¯é€±æª¢è¦–</span>
        </button>
        <button onclick="switchPage('history')" id="nav-history" class="nav-item flex flex-col items-center gap-1 text-slate-400">
            <i data-lucide="history" class="w-6 h-6"></i>
            <span class="text-[11px] font-black">æ­·å²æ­·ç¨‹</span>
        </button>
    </nav>

    <script>
        lucide.createIcons();
        document.getElementById('current-date').innerText = new Date().toLocaleDateString('zh-TW', { month: 'long', day: 'numeric', weekday: 'long' });

        let proChart = null;

        function updatePortion(type, val) {
            const el = document.getElementById(`val-${type}`);
            let curr = parseFloat(el.innerText);
            el.innerText = Math.max(0, curr + val).toFixed(1);
        }

        function toggleBtn(btn) {
            btn.parentElement.querySelectorAll('button').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        }

        function triggerUpload(type) { document.getElementById(`file-${type}`).click(); }

        function previewImg(input, imgId) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = e => {
                    const img = document.getElementById(imgId);
                    img.src = e.target.result;
                    img.classList.remove('hidden');
                    input.parentElement.querySelectorAll('i, span').forEach(el => el.style.display = 'none');
                };
                reader.readAsDataURL(input.files[0]);
            }
        }

        function switchPage(p) {
            document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
            document.querySelectorAll('.nav-item').forEach(nav => { 
                nav.classList.remove('active'); 
                nav.classList.add('text-slate-400'); 
            });
            const targetPage = document.getElementById(`${p}-page`);
            if (targetPage) {
                targetPage.classList.add('active');
                document.getElementById(`nav-${p}`).classList.add('active');
                document.getElementById(`nav-${p}`).classList.remove('text-slate-400');
                if(p === 'insights') { setTimeout(() => { renderChart(); renderWeeklyDetails(); }, 50); }
            }
            window.scrollTo(0,0);
            lucide.createIcons();
        }

        function saveData() {
            const btn = document.getElementById('save-btn');
            btn.innerText = "æ­£åœ¨å„²å­˜...";
            setTimeout(() => {
                btn.innerText = "å„²å­˜æˆåŠŸ";
                btn.classList.replace('bg-slate-900', 'bg-green-600');
                setTimeout(() => {
                    btn.innerText = "ç¢ºèªå„²å­˜ä»Šæ—¥ç´€éŒ„";
                    btn.classList.replace('bg-green-600', 'bg-slate-900');
                    switchPage('insights');
                }, 800);
            }, 1000);
        }

        function renderWeeklyDetails() {
            const list = document.getElementById('weekly-details-list');
            const weekDays = [
                { day: 'é€±ä¸€', date: '1/21', w: 66.5, c: 84.0, carb: 2.5, prot: 2.5, veg: 3.0, water: 2500, sleep: 7.0, poop: 'é †æš¢', evil: 'å¦', photos: [true, true, true, true] },
                { day: 'é€±äºŒ', date: '1/22', w: 66.2, c: 83.0, carb: 2.0, prot: 3.0, veg: 2.5, water: 2000, sleep: 6.5, poop: 'ç¡¬ä¹¾', evil: 'å¦', photos: [true, true, true, false] },
                { day: 'é€±ä¸‰', date: '1/23', w: 65.8, c: 83.5, carb: 2.5, prot: 2.5, veg: 3.0, water: 2200, sleep: 8.0, poop: 'é †æš¢', evil: 'å¦', photos: [true, true, true, true] },
                { day: 'é€±å››', date: '1/24', w: 65.9, c: 82.5, carb: 3.0, prot: 2.0, veg: 2.0, water: 1500, sleep: 5.5, poop: 'æ²’ä¸Š', evil: 'æ˜¯', photos: [true, false, true, false] },
                { day: 'é€±äº”', date: '1/25', w: 65.5, c: 82.5, carb: 2.0, prot: 2.5, veg: 3.5, water: 2400, sleep: 7.5, poop: 'é †æš¢', evil: 'å¦', photos: [true, true, true, true] },
                { day: 'é€±å…­', date: '1/26', w: 65.6, c: 82.5, carb: 4.0, prot: 3.0, veg: 1.5, water: 1200, sleep: 6.0, poop: 'ç¡¬ä¹¾', evil: 'æ˜¯', photos: [true, true, true, false] },
                { day: 'é€±æ—¥', date: '1/27', w: 65.2, c: 82.0, carb: 1.5, prot: 2.0, veg: 2.5, water: 2200, sleep: 7.5, poop: 'é †æš¢', evil: 'å¦', photos: [true, true, true, true] }
            ];

            list.innerHTML = weekDays.map(d => `
                <div class="ios-card overflow-hidden">
                    <div class="bg-slate-50 px-4 py-2 flex justify-between items-center border-b border-slate-100">
                        <div class="flex items-center gap-2">
                            <span class="text-base font-black text-slate-800">${d.day}</span>
                            <span class="text-[10px] font-bold text-slate-400">${d.date}</span>
                        </div>
                        <div class="text-right">
                            <span class="text-sm font-black text-indigo-600">${d.w}kg</span>
                            <span class="text-[10px] font-bold text-pink-500 ml-1">/ ${d.c}cm</span>
                        </div>
                    </div>
                    
                    <div class="p-3">
                        <div class="flex items-center justify-between mb-3">
                            <div class="flex gap-1.5">
                                <div class="bg-indigo-50 px-2 py-0.5 rounded-lg border border-indigo-100 flex flex-col items-center">
                                    <span class="text-[8px] font-bold text-indigo-400 leading-none mt-1">ä¸»</span>
                                    <span class="text-xs font-black text-indigo-700">${d.carb}</span>
                                </div>
                                <div class="bg-orange-50 px-2 py-0.5 rounded-lg border border-orange-100 flex flex-col items-center">
                                    <span class="text-[8px] font-bold text-orange-400 leading-none mt-1">è›‹</span>
                                    <span class="text-xs font-black text-orange-700">${d.prot}</span>
                                </div>
                                <div class="bg-green-50 px-2 py-0.5 rounded-lg border border-green-100 flex flex-col items-center">
                                    <span class="text-[8px] font-bold text-green-400 leading-none mt-1">è”¬</span>
                                    <span class="text-xs font-black text-green-700">${d.veg}</span>
                                </div>
                            </div>
                            <div class="text-right leading-tight">
                                <span class="block text-[9px] font-bold text-slate-400 uppercase">é£²æ°´ / ç¡çœ </span>
                                <span class="text-xs font-black text-slate-700">${d.water}cc / ${d.sleep}h</span>
                            </div>
                        </div>

                        <div class="flex flex-wrap gap-1.5 mb-3">
                            <span class="text-[9px] font-bold px-2 py-0.5 rounded-md ${d.poop === 'é †æš¢' ? 'bg-green-100 text-green-700' : 'bg-orange-100 text-orange-700'}">ä¾¿ä¾¿: ${d.poop}</span>
                            <span class="text-[9px] font-bold px-2 py-0.5 rounded-md ${d.evil === 'å¦' ? 'bg-slate-100 text-slate-600' : 'bg-red-100 text-red-700'}">é‚ªæƒ¡: ${d.evil}</span>
                        </div>

                        <div class="flex gap-2 border-t border-slate-50 pt-2.5">
                            ${d.photos.map((hasPhoto, idx) => {
                                const labels = ['æ—©','åˆ','æ™š','é«”'];
                                return hasPhoto ? `<div class="mini-photo-placeholder bg-indigo-50 border-indigo-100 text-indigo-500">${labels[idx]}</div>` : `<div class="mini-photo-placeholder">ç„¡</div>`;
                            }).join('')}
                            <div class="ml-auto text-[9px] text-slate-300 font-bold self-end">Day Snap</div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function renderChart() {
            const canvas = document.getElementById('proWeeklyChart');
            if (!canvas) return;
            const ctx = canvas.getContext('2d');
            if (proChart !== null) proChart.destroy();
            proChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['é€±ä¸€','é€±äºŒ','é€±ä¸‰','é€±å››','é€±äº”','é€±å…­','é€±æ—¥'],
                    datasets: [
                        { label: 'é«”é‡', data: [66.5, 66.2, 65.8, 65.9, 65.5, 65.6, 65.2], borderColor: '#4F46E5', borderWidth: 3, tension: 0.4, pointRadius: 3, pointBackgroundColor: '#fff', yAxisID: 'y' },
                        { label: 'è…°åœ', data: [84.0, 83.0, 83.5, 82.5, 82.5, 82.5, 82.0], borderColor: '#EC4899', borderWidth: 2, borderDash:[4,4], tension: 0.4, pointRadius: 0, yAxisID: 'y1' }
                    ]
                },
                options: { 
                    responsive: true, maintainAspectRatio: false, 
                    scales: { 
                        y: { position: 'left', grid: { display: false }, ticks: { font: { size: 9 }, color: '#4F46E5' } },
                        y1: { position: 'right', grid: { display: false }, ticks: { font: { size: 9 }, color: '#EC4899' } },
                        x: { grid: { display: false }, ticks: { font: { size: 10 } } } 
                    },
                    plugins: { legend: { display: false } } 
                }
            });
        }

        window.onload = () => { renderChart(); renderWeeklyDetails(); };
    </script>
</body>
</html>
